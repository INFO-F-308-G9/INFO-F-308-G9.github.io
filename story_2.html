<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8"/>
    <link rel="stylesheet" href="index.css"/>
    <title>Simulations De Population : Histoire numéro 2</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@2.9.4/dist/Chart.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.2.0/p5.min.js"></script>
</head>
<body>

<header>
    <h1>Histoire 2 </h1>
</header>


<script>
    let table;
    let gen_pop
    let nbr_pop
    let myChart;

   function preload() {
     table = loadTable('second_story_moyenne.csv', 'csv', 'header');
     //table = loadTable("http://p5js.org/reference/assets/mammals.csv",
     //                  "csv", "header");
     table_1 = loadTable('patch.csv','csv','header');
   }

   function setup() {
     const toNumbers = arr => arr.map(Number);
     var off_pop = toNumbers(table.getColumn("off.nbr"));
     var adlt_pop = toNumbers(table.getColumn("adlt.nbr"));
     nbr_pop =(off_pop.map(function (num, idx) {
     return num + adlt_pop[idx];}))
     gen_pop =(table.getColumn("generation"));

     var ctx = document.getElementById('line-chart');
      myChart = new Chart(ctx, {
        type: 'line',
        data: {
          labels: gen_pop,
          datasets: [              {
              data: nbr_pop,
              label: "Populations",
              borderColor: "#3e95cd",
              backgroundColor : "#3e95cd ",
              fill: false
              },
              {
              data: off_pop,
              label: "Nombre d'enfants",
              borderColor: "#8e5ea2",
              backgroundColor : "#8e5ea2",
              fill: false}
                    ]
              },

        options: {
          title: {
            display: true,
            text: "Nombre d'individus par génération d'une population"
          }
        }
      }
    );
      var ctx_1 = document.getElementById('pie-chart');
      extrate = table_1.getColumn("extrate")
      print(extrate[ extrate.length-1])
      myChart = new Chart(ctx_1, {
        type: 'pie',
        data: {
          label:"Proportions de Patchs ",
          datasets: [
              {
              data: [extrate[ extrate.length-1],1-extrate[ extrate.length-1]],
              backgroundColor : ["#c45850","#3cba9f"],
              borderColor: ["#c45850","#3cba9f"],
              fill: false
            }],
          labels: ["Eteints","Vivant"]
       },

        options: {
          title: {
            display: true,
            text: "Proportion de Patchs"
          }
        }
      });

    new Chart(document.getElementById("bar-chart"), {
    //TODO additionner les colonnes des différents patch hommes et femmes, dans un array pop_patch, et push 8fois car 8 patch, reprendre le code au dessus.
      type: 'bar',
    data: {
      labels: ["Patch 1", "Patch 2", "Patch 3", "Patch 4", "Patch 5","Patch 6","Patch 7","Patch 8","Patch 9"],
      datasets: [
        {
          label: "Population (millions)",
          backgroundColor: ["#3e95cd", "#8e5ea2","#3cba9f","#e8c3b9","#c45850","#3e95cd", "#8e5ea2","#3cba9f","#e8c3b9"],
          data: table_1.getColumn("")
        }
      ]
    },
    options: {
      legend: { display: false },
      title: {
        display: true,
        text: 'Predicted world population (millions) in 2050'
      }
    }
});

    };


</script>
<nav>
    <ul>
        <li><a href="index.html">Introduction</a></li>
        <li><a href="story_1.html">Histoire 1</a></li>
        <li><a href="story_2.html">Histoire 2</a></li>
    </ul>
</nav>


<div id="volet_clos">
    <div id="volet">
        <img src="images/infographie_reelle_h2_p1.jpg" alt="Premier parallèle avec les faits réels" height="1000"
             width="600"/>
        <img src="images/infographie_reelle_h2_p2.jpg" alt="Premier parallèle avec les faits réels" height="1000"
             width="600"/>

        <a href="#volet" class="ouvrir">Faits réels associés</a>
        <a href="#volet_clos" class="fermer">Histoire imaginaire</a>
    </div>
</div>


<p>
    <br/>
    <img src="images/infographie_imaginaire_h2_p1.jpg" alt="Première partie de l'histoire 2" height="1000" width="600"/>
</p>
<p>
    <img src="images/infographie_imaginaire_h2_p2.jpg" alt="Première partie de l'histoire 2" height="1000" width="600"/>
</p>

<section>

    <h3>
        Voici quelques liens à suivre si vous désirez en apprendre plus sur ces espèces en danger.
        Par catégorie, ces espèces ont principalement été victimes...
    </h3>
    <p>...de la déforestation.</p>
    <a href="https://www.larousse.fr/encyclopedie/vie-sauvage/tigre/178156">Le tigre</a>
    <p>...de la pollution.</p>
    <a href="https://www.futura-sciences.com/planete/definitions/zoologie-anguille-europeenne-7725/">L'anguille
        européenne</a>
    <p>...de l'introduction d'une autre espèce.</p>
    <a href=" https://www.iguanafoundation.org/what-we-support/rock-iguanas/jamaican-rock-iguana/">L'iguane terrestre de
        la Jamaïque,</a>
    <p></p>
    <a href="http://www.oiseaux-birds.com/fiche-foudi-de-maurice.html">le foudi de Maurice</a>
    <p></p>
    <a href="https://www.tahiti-infos.com/Le-monarque-de-Fatu-Hiva-une-espece-en-voie-d-extinction_a143244.html">le
        monarque de Fatu Hiva</a>


</section>

<div class="main_flex" style="width: 100%;height:1000px">
    <div class="graph_1" style="width: 100%;height:600px">
        <div style="width: 80%;height: 10%">
            <canvas id="line-chart"></canvas>
        </div>
    </div>

    <div class="flex_container" style="width: 100%;height:400px">
        <div style="width: 400px;height:100%">
            <canvas id="pie-chart"></canvas>
        </div>
        <div style="width: 400px;height:100%">
            <canvas id="bar-chart"></canvas>
        </div>
    </div>
</div>
</body>
</html>
